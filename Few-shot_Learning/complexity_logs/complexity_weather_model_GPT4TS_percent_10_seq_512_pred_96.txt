train 74382
val 108675
test 219324
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0-5): 6 x GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
-------------------------------------------------- MACs across 10% train data = 108.975G nparams = 733.536K
self vs thop trainable params 1519968 733.536K
0it [00:00, ?it/s]1it [00:01,  1.00s/it]6it [00:01,  6.93it/s]11it [00:01, 13.29it/s]17it [00:01, 20.80it/s]23it [00:01, 27.66it/s]29it [00:01, 33.55it/s]35it [00:01, 38.87it/s]41it [00:01, 42.63it/s]48it [00:01, 48.12it/s]54it [00:02, 50.62it/s]61it [00:02, 54.11it/s]68it [00:02, 56.39it/s]74it [00:02, 56.82it/s]80it [00:02, 57.60it/s]87it [00:02, 59.01it/s]93it [00:02, 58.18it/s]100it [00:02, 58.78it/s]106it [00:02, 59.07it/s]113it [00:02, 58.94it/s]120it [00:03, 59.30it/s]127it [00:03, 59.81it/s]133it [00:03, 58.99it/s]139it [00:03, 54.59it/s]145it [00:03, 53.39it/s]151it [00:03, 52.47it/s]157it [00:03, 51.96it/s]163it [00:03, 51.58it/s]169it [00:04, 51.21it/s]175it [00:04, 50.98it/s]181it [00:04, 50.84it/s]187it [00:04, 50.64it/s]193it [00:04, 50.44it/s]199it [00:04, 50.43it/s]205it [00:04, 50.33it/s]211it [00:04, 50.28it/s]217it [00:05, 50.27it/s]223it [00:05, 50.27it/s]229it [00:05, 50.31it/s]235it [00:05, 50.31it/s]241it [00:05, 50.40it/s]247it [00:05, 50.03it/s]253it [00:05, 50.01it/s]259it [00:05, 50.05it/s]265it [00:05, 50.16it/s]271it [00:06, 50.17it/s]277it [00:06, 50.15it/s]283it [00:06, 50.12it/s]289it [00:06, 50.24it/s]295it [00:06, 48.31it/s]300it [00:06, 47.44it/s]305it [00:06, 47.75it/s]310it [00:06, 47.35it/s]315it [00:07, 47.62it/s]320it [00:07, 48.03it/s]325it [00:07, 48.13it/s]330it [00:07, 48.05it/s]335it [00:07, 48.18it/s]340it [00:07, 48.44it/s]345it [00:07, 48.50it/s]350it [00:07, 48.60it/s]355it [00:07, 48.55it/s]360it [00:07, 48.74it/s]365it [00:08, 48.46it/s]370it [00:08, 48.58it/s]375it [00:08, 48.60it/s]380it [00:08, 48.64it/s]385it [00:08, 48.74it/s]390it [00:08, 48.70it/s]395it [00:08, 48.56it/s]400it [00:08, 48.65it/s]405it [00:08, 48.58it/s]410it [00:08, 48.54it/s]415it [00:09, 48.61it/s]420it [00:09, 48.75it/s]425it [00:09, 48.69it/s]430it [00:09, 48.82it/s]435it [00:09, 48.73it/s]440it [00:09, 48.82it/s]445it [00:09, 48.65it/s]450it [00:09, 48.93it/s]455it [00:09, 48.86it/s]460it [00:09, 49.18it/s]465it [00:10, 49.33it/s]470it [00:10, 49.47it/s]475it [00:10, 49.45it/s]481it [00:10, 49.66it/s]486it [00:10, 49.61it/s]491it [00:10, 49.58it/s]496it [00:10, 49.61it/s]501it [00:10, 49.50it/s]506it [00:10, 49.55it/s]511it [00:11, 49.56it/s]516it [00:11, 49.65it/s]521it [00:11, 49.74it/s]526it [00:11, 49.80it/s]531it [00:11, 49.74it/s]536it [00:11, 49.79it/s]541it [00:11, 49.85it/s]546it [00:11, 49.73it/s]551it [00:11, 49.74it/s]557it [00:11, 49.87it/s]563it [00:12, 49.93it/s]569it [00:12, 49.97it/s]574it [00:12, 49.89it/s]579it [00:12, 49.90it/s]585it [00:12, 49.92it/s]590it [00:12, 49.84it/s]595it [00:12, 49.84it/s]601it [00:12, 49.99it/s]606it [00:12, 49.96it/s]611it [00:13, 49.66it/s]616it [00:13, 49.70it/s]622it [00:13, 51.67it/s]628it [00:13, 54.01it/s]634it [00:13, 51.70it/s]640it [00:13, 52.14it/s]647it [00:13, 55.21it/s]654it [00:13, 57.27it/s]660it [00:13, 57.18it/s]666it [00:13, 57.96it/s]672it [00:14, 57.35it/s]679it [00:14, 58.28it/s]685it [00:14, 58.74it/s]692it [00:14, 59.35it/s]699it [00:14, 59.73it/s]705it [00:14, 59.69it/s]712it [00:14, 60.29it/s]719it [00:14, 59.97it/s]726it [00:14, 59.82it/s]732it [00:15, 57.44it/s]738it [00:15, 57.85it/s]745it [00:15, 58.04it/s]752it [00:15, 58.69it/s]758it [00:15, 57.48it/s]764it [00:15, 58.08it/s]771it [00:15, 59.35it/s]777it [00:15, 58.18it/s]783it [00:15, 55.68it/s]790it [00:16, 57.69it/s]796it [00:16, 57.67it/s]803it [00:16, 58.63it/s]810it [00:16, 59.76it/s]816it [00:16, 58.48it/s]822it [00:16, 55.92it/s]828it [00:16, 53.30it/s]834it [00:16, 52.23it/s]840it [00:17, 52.83it/s]846it [00:17, 52.09it/s]852it [00:17, 51.55it/s]858it [00:17, 51.22it/s]864it [00:17, 50.96it/s]870it [00:17, 50.68it/s]876it [00:17, 50.49it/s]882it [00:17, 51.99it/s]889it [00:17, 54.60it/s]896it [00:18, 56.47it/s]902it [00:18, 56.56it/s]908it [00:18, 57.48it/s]914it [00:18, 57.65it/s]920it [00:18, 57.53it/s]927it [00:18, 58.58it/s]934it [00:18, 58.88it/s]940it [00:18, 58.90it/s]946it [00:18, 59.13it/s]953it [00:19, 59.48it/s]959it [00:19, 59.18it/s]965it [00:19, 59.08it/s]972it [00:19, 60.12it/s]979it [00:19, 60.06it/s]986it [00:19, 59.79it/s]993it [00:19, 60.42it/s]1000it [00:19, 58.49it/s]1006it [00:19, 57.71it/s]1013it [00:20, 59.03it/s]1019it [00:20, 59.04it/s]1025it [00:20, 55.79it/s]1031it [00:20, 53.83it/s]1037it [00:20, 53.44it/s]1043it [00:20, 54.92it/s]1049it [00:20, 56.17it/s]1056it [00:20, 57.37it/s]1063it [00:20, 58.43it/s]1069it [00:21, 58.86it/s]1076it [00:21, 59.20it/s]1083it [00:21, 59.02it/s]1089it [00:21, 56.02it/s]1095it [00:21, 53.92it/s]1101it [00:21, 52.52it/s]1107it [00:21, 53.69it/s]1113it [00:21, 55.20it/s]1119it [00:21, 56.38it/s]1126it [00:22, 57.48it/s]1132it [00:22, 57.98it/s]1139it [00:22, 58.61it/s]1146it [00:22, 60.50it/s]1154it [00:22, 63.70it/s]1161it [00:22, 62.65it/s]1162it [00:22, 51.15it/s]
	iters: 1000, epoch: 1 | loss: 0.1225211
	speed: 0.0238s/iter; left time: 3.8731s
-------------------------------------------------- Epoch: 1 cost time: 23.177205801010132
0it [00:00, ?it/s]3it [00:00, 24.23it/s]11it [00:00, 50.99it/s]19it [00:00, 62.08it/s]27it [00:00, 67.45it/s]35it [00:00, 69.49it/s]43it [00:00, 65.78it/s]51it [00:00, 69.31it/s]61it [00:00, 76.79it/s]71it [00:01, 82.80it/s]81it [00:01, 85.26it/s]91it [00:01, 89.00it/s]101it [00:01, 91.75it/s]112it [00:01, 94.66it/s]123it [00:01, 96.54it/s]134it [00:01, 97.89it/s]145it [00:01, 98.92it/s]155it [00:01, 98.28it/s]165it [00:01, 98.72it/s]176it [00:02, 99.27it/s]186it [00:02, 99.30it/s]197it [00:02, 99.56it/s]208it [00:02, 100.07it/s]219it [00:02, 99.77it/s] 230it [00:02, 100.45it/s]241it [00:02, 98.84it/s] 251it [00:02, 96.17it/s]261it [00:02, 97.15it/s]271it [00:03, 97.95it/s]282it [00:03, 98.84it/s]293it [00:03, 99.15it/s]304it [00:03, 99.51it/s]315it [00:03, 100.08it/s]326it [00:03, 100.20it/s]337it [00:03, 100.53it/s]348it [00:03, 100.74it/s]359it [00:03, 100.45it/s]370it [00:04, 100.64it/s]381it [00:04, 100.50it/s]392it [00:04, 100.30it/s]403it [00:04, 99.74it/s] 413it [00:04, 99.14it/s]424it [00:04, 99.60it/s]435it [00:04, 100.10it/s]446it [00:04, 100.59it/s]457it [00:04, 99.57it/s] 468it [00:04, 100.03it/s]479it [00:05, 100.26it/s]490it [00:05, 100.46it/s]501it [00:05, 100.69it/s]512it [00:05, 100.76it/s]523it [00:05, 100.76it/s]534it [00:05, 100.87it/s]545it [00:05, 101.29it/s]556it [00:05, 101.31it/s]567it [00:05, 98.33it/s] 578it [00:06, 98.98it/s]589it [00:06, 99.64it/s]600it [00:06, 100.31it/s]611it [00:06, 99.54it/s] 621it [00:06, 93.93it/s]631it [00:06, 94.89it/s]641it [00:06, 95.42it/s]651it [00:06, 96.03it/s]662it [00:06, 97.72it/s]672it [00:07, 97.76it/s]683it [00:07, 98.64it/s]694it [00:07, 99.52it/s]705it [00:07, 100.17it/s]716it [00:07, 100.36it/s]727it [00:07, 100.10it/s]738it [00:07, 100.40it/s]749it [00:07, 100.73it/s]760it [00:07, 101.05it/s]771it [00:08, 101.25it/s]782it [00:08, 101.42it/s]793it [00:08, 100.40it/s]804it [00:08, 99.91it/s] 814it [00:08, 99.55it/s]824it [00:08, 99.40it/s]834it [00:08, 98.99it/s]845it [00:08, 99.79it/s]856it [00:08, 99.89it/s]866it [00:08, 99.71it/s]877it [00:09, 100.03it/s]888it [00:09, 100.33it/s]899it [00:09, 100.80it/s]910it [00:09, 100.73it/s]921it [00:09, 101.17it/s]932it [00:09, 101.97it/s]943it [00:09, 102.24it/s]954it [00:09, 102.56it/s]965it [00:09, 100.64it/s]976it [00:10, 101.26it/s]987it [00:10, 101.45it/s]998it [00:10, 98.94it/s] 1008it [00:10, 98.95it/s]1018it [00:10, 98.96it/s]1029it [00:10, 99.94it/s]1040it [00:10, 100.89it/s]1051it [00:10, 100.55it/s]1062it [00:10, 100.13it/s]1073it [00:11, 96.93it/s] 1084it [00:11, 98.54it/s]1095it [00:11, 99.82it/s]1106it [00:11, 100.69it/s]1117it [00:11, 100.78it/s]1128it [00:11, 100.71it/s]1139it [00:11, 101.18it/s]1150it [00:11, 93.17it/s] 1160it [00:11, 91.16it/s]1170it [00:12, 93.24it/s]1180it [00:12, 94.41it/s]1190it [00:12, 95.75it/s]1201it [00:12, 98.47it/s]1212it [00:12, 100.27it/s]1223it [00:12, 100.91it/s]1234it [00:12, 101.47it/s]1245it [00:12, 101.82it/s]1256it [00:12, 101.98it/s]1267it [00:13, 101.20it/s]1278it [00:13, 101.63it/s]1289it [00:13, 101.78it/s]1300it [00:13, 101.84it/s]1311it [00:13, 92.85it/s] 1321it [00:13, 86.86it/s]1330it [00:13, 83.21it/s]1339it [00:13, 78.27it/s]1347it [00:13, 77.10it/s]1355it [00:14, 76.56it/s]1363it [00:14, 76.26it/s]1373it [00:14, 81.68it/s]1384it [00:14, 87.89it/s]1395it [00:14, 92.45it/s]1405it [00:14, 94.47it/s]1415it [00:14, 94.62it/s]1426it [00:14, 97.48it/s]1437it [00:14, 99.11it/s]1447it [00:15, 99.04it/s]1457it [00:15, 98.90it/s]1467it [00:15, 97.91it/s]1477it [00:15, 97.78it/s]1487it [00:15, 98.17it/s]1497it [00:15, 98.46it/s]1507it [00:15, 98.65it/s]1518it [00:15, 100.06it/s]1529it [00:15, 100.70it/s]1540it [00:15, 101.36it/s]1551it [00:16, 101.67it/s]1562it [00:16, 101.83it/s]1573it [00:16, 100.99it/s]1584it [00:16, 101.80it/s]1595it [00:16, 102.04it/s]1606it [00:16, 101.16it/s]1617it [00:16, 100.13it/s]1628it [00:16, 100.39it/s]1639it [00:16, 100.93it/s]1650it [00:17, 101.58it/s]1661it [00:17, 101.74it/s]1672it [00:17, 99.85it/s] 1684it [00:17, 104.08it/s]1697it [00:17, 110.67it/s]1698it [00:17, 96.69it/s] 
Epoch: 1, Steps: 1162 | Train Loss: 0.1400978 Vali Loss: 0.4808896
lr_adjust = {1: 0.0001}
Updating learning rate to 0.0001
Validation loss decreased (inf --> 0.480890).  Saving model ...
------------------------------------
0it [00:00, ?it/s]9it [00:00, 87.46it/s]26it [00:00, 135.22it/s]41it [00:00, 141.64it/s]56it [00:00, 144.57it/s]71it [00:00, 145.58it/s]86it [00:00, 146.64it/s]101it [00:00, 146.60it/s]116it [00:00, 146.99it/s]131it [00:00, 147.38it/s]146it [00:01, 145.71it/s]161it [00:01, 145.69it/s]176it [00:01, 145.56it/s]191it [00:01, 145.47it/s]206it [00:01, 146.53it/s]221it [00:01, 143.06it/s]236it [00:01, 144.60it/s]251it [00:01, 145.53it/s]266it [00:01, 145.49it/s]281it [00:01, 146.12it/s]296it [00:02, 146.78it/s]311it [00:02, 147.15it/s]326it [00:02, 146.70it/s]341it [00:02, 146.97it/s]356it [00:02, 147.76it/s]371it [00:02, 147.75it/s]387it [00:02, 148.15it/s]402it [00:02, 147.50it/s]417it [00:02, 148.04it/s]432it [00:02, 148.10it/s]447it [00:03, 148.37it/s]462it [00:03, 146.93it/s]477it [00:03, 147.65it/s]492it [00:03, 148.08it/s]508it [00:03, 148.87it/s]523it [00:03, 148.42it/s]539it [00:03, 148.93it/s]554it [00:03, 148.99it/s]569it [00:03, 148.98it/s]584it [00:03, 148.77it/s]599it [00:04, 147.23it/s]614it [00:04, 147.20it/s]629it [00:04, 147.38it/s]644it [00:04, 147.72it/s]659it [00:04, 147.49it/s]674it [00:04, 147.98it/s]689it [00:04, 147.38it/s]704it [00:04, 147.90it/s]719it [00:04, 147.97it/s]734it [00:05, 147.55it/s]749it [00:05, 147.93it/s]764it [00:05, 148.40it/s]779it [00:05, 148.64it/s]794it [00:05, 148.74it/s]809it [00:05, 148.78it/s]824it [00:05, 148.91it/s]839it [00:05, 148.78it/s]854it [00:05, 148.76it/s]869it [00:05, 147.17it/s]884it [00:06, 147.55it/s]899it [00:06, 147.83it/s]914it [00:06, 148.11it/s]929it [00:06, 148.34it/s]944it [00:06, 147.97it/s]959it [00:06, 148.00it/s]974it [00:06, 148.07it/s]989it [00:06, 148.16it/s]1004it [00:06, 148.05it/s]1019it [00:06, 147.45it/s]1034it [00:07, 147.92it/s]1049it [00:07, 148.10it/s]1064it [00:07, 148.27it/s]1079it [00:07, 148.23it/s]1094it [00:07, 148.22it/s]1109it [00:07, 148.38it/s]1124it [00:07, 147.99it/s]1139it [00:07, 147.94it/s]1154it [00:07, 148.40it/s]1169it [00:07, 148.53it/s]1184it [00:08, 148.65it/s]1199it [00:08, 148.78it/s]1214it [00:08, 148.56it/s]1229it [00:08, 148.83it/s]1244it [00:08, 148.86it/s]1259it [00:08, 148.61it/s]1274it [00:08, 148.74it/s]1289it [00:08, 148.48it/s]1304it [00:08, 148.52it/s]1319it [00:08, 148.73it/s]1334it [00:09, 148.91it/s]1349it [00:09, 149.10it/s]1364it [00:09, 149.04it/s]1379it [00:09, 149.07it/s]1394it [00:09, 148.67it/s]1409it [00:09, 148.43it/s]1424it [00:09, 148.58it/s]1439it [00:09, 148.61it/s]1454it [00:09, 148.79it/s]1469it [00:09, 148.44it/s]1484it [00:10, 148.75it/s]1499it [00:10, 148.65it/s]1514it [00:10, 148.71it/s]1529it [00:10, 148.44it/s]1544it [00:10, 148.51it/s]1559it [00:10, 148.67it/s]1574it [00:10, 149.03it/s]1589it [00:10, 148.93it/s]1604it [00:10, 148.93it/s]1619it [00:10, 148.81it/s]1634it [00:11, 148.67it/s]1649it [00:11, 146.91it/s]1664it [00:11, 147.43it/s]1679it [00:11, 147.87it/s]1694it [00:11, 148.16it/s]1709it [00:11, 148.30it/s]1724it [00:11, 148.33it/s]1739it [00:11, 148.37it/s]1754it [00:11, 148.45it/s]1769it [00:11, 148.46it/s]1784it [00:12, 148.35it/s]1799it [00:12, 148.47it/s]1814it [00:12, 148.73it/s]1829it [00:12, 148.79it/s]1844it [00:12, 148.06it/s]1859it [00:12, 148.32it/s]1875it [00:12, 148.93it/s]1890it [00:12, 149.14it/s]1905it [00:12, 149.23it/s]1920it [00:12, 148.94it/s]1935it [00:13, 148.67it/s]1950it [00:13, 148.82it/s]1965it [00:13, 148.78it/s]1980it [00:13, 148.96it/s]1995it [00:13, 148.21it/s]2010it [00:13, 148.67it/s]2025it [00:13, 148.61it/s]2040it [00:13, 148.85it/s]2055it [00:13, 148.49it/s]2070it [00:14, 148.79it/s]2085it [00:14, 148.87it/s]2101it [00:14, 149.23it/s]2116it [00:14, 149.08it/s]2131it [00:14, 149.19it/s]2146it [00:14, 149.06it/s]2161it [00:14, 148.52it/s]2176it [00:14, 148.58it/s]2191it [00:14, 148.66it/s]2206it [00:14, 148.78it/s]2221it [00:15, 148.72it/s]2236it [00:15, 148.94it/s]2251it [00:15, 148.71it/s]2266it [00:15, 148.94it/s]2281it [00:15, 148.69it/s]2296it [00:15, 148.85it/s]2311it [00:15, 148.68it/s]2326it [00:15, 148.11it/s]2341it [00:15, 148.05it/s]2356it [00:15, 148.29it/s]2371it [00:16, 148.13it/s]2386it [00:16, 148.19it/s]2401it [00:16, 148.52it/s]2416it [00:16, 147.39it/s]2431it [00:16, 147.54it/s]2446it [00:16, 148.20it/s]2461it [00:16, 148.43it/s]2476it [00:16, 148.11it/s]2491it [00:16, 148.23it/s]2506it [00:16, 148.50it/s]2521it [00:17, 148.80it/s]2537it [00:17, 149.02it/s]2553it [00:17, 149.24it/s]2568it [00:17, 149.37it/s]2583it [00:17, 149.41it/s]2598it [00:17, 149.43it/s]2613it [00:17, 149.36it/s]2629it [00:17, 149.50it/s]2645it [00:17, 149.40it/s]2661it [00:17, 149.66it/s]2677it [00:18, 149.28it/s]2693it [00:18, 149.58it/s]2708it [00:18, 149.63it/s]2723it [00:18, 148.98it/s]2738it [00:18, 148.75it/s]2753it [00:18, 148.96it/s]2768it [00:18, 149.22it/s]2783it [00:18, 149.28it/s]2798it [00:18, 149.42it/s]2813it [00:18, 149.17it/s]2828it [00:19, 148.95it/s]2843it [00:19, 149.08it/s]2858it [00:19, 149.13it/s]2873it [00:19, 149.22it/s]2888it [00:19, 149.42it/s]2903it [00:19, 148.90it/s]2918it [00:19, 148.69it/s]2933it [00:19, 148.60it/s]2948it [00:19, 148.94it/s]2963it [00:20, 149.12it/s]2978it [00:20, 149.27it/s]2994it [00:20, 149.61it/s]3009it [00:20, 149.31it/s]3025it [00:20, 149.72it/s]3040it [00:20, 149.78it/s]3055it [00:20, 149.65it/s]3070it [00:20, 149.64it/s]3085it [00:20, 149.64it/s]3100it [00:20, 149.48it/s]3116it [00:21, 149.81it/s]3131it [00:21, 149.65it/s]3147it [00:21, 149.80it/s]3162it [00:21, 149.82it/s]3177it [00:21, 149.75it/s]3192it [00:21, 149.79it/s]3207it [00:21, 149.70it/s]3223it [00:21, 149.72it/s]3239it [00:21, 149.80it/s]3254it [00:21, 149.64it/s]3269it [00:22, 149.60it/s]3285it [00:22, 149.70it/s]3301it [00:22, 149.74it/s]3316it [00:22, 149.64it/s]3331it [00:22, 149.02it/s]3346it [00:22, 148.94it/s]3361it [00:22, 148.94it/s]3377it [00:22, 149.17it/s]3393it [00:22, 149.28it/s]3409it [00:22, 149.83it/s]3425it [00:23, 151.48it/s]3426it [00:23, 148.00it/s]
test shape: (3426, 64, 96, 1) (3426, 64, 96, 1)
test shape: (219264, 96, 1) (219264, 96, 1)
mae:0.2210, mse:0.1700, rmse:0.4124, smape:56.8212
-------------------------------------------------- TEST time = 23.90816068649292
mse_mean = 0.1700, mse_std = 0.0000
mae_mean = 0.2210, mae_std = 0.0000
****************************************************************************************************
======================================== Runtime metrics ========================================
MACs = 108.975G
params = 733.536K
total params = 82.626M
epoch time = 23.177205801010132
max memory = 619.12 MB
test time = 23.90816068649292
****************************************************************************************************
