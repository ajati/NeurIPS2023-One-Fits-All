self.enc_in = 7
self.data_x = (1324, 7)
train 5019
self.enc_in = 7
self.data_x = (3392, 7)
val 19495
self.enc_in = 7
self.data_x = (3392, 7)
test 19495
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0-5): 6 x GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
-------------------------------------------------- MACs across 10% train data = 20.749G nparams = 2.466M
0it [00:00, ?it/s]1it [00:00,  8.14it/s]4it [00:00, 18.45it/s]7it [00:00, 21.43it/s]10it [00:00, 22.85it/s]13it [00:00, 23.61it/s]16it [00:00, 24.10it/s]19it [00:00, 24.40it/s]22it [00:00, 24.60it/s]25it [00:01, 24.72it/s]28it [00:01, 24.81it/s]31it [00:01, 24.88it/s]34it [00:01, 24.92it/s]37it [00:01, 25.05it/s]40it [00:01, 26.21it/s]43it [00:01, 27.07it/s]46it [00:01, 27.69it/s]49it [00:01, 28.16it/s]52it [00:02, 28.48it/s]55it [00:02, 28.70it/s]58it [00:02, 28.39it/s]61it [00:02, 28.66it/s]64it [00:02, 28.84it/s]67it [00:02, 28.97it/s]70it [00:02, 29.07it/s]73it [00:02, 29.14it/s]76it [00:02, 29.17it/s]78it [00:03, 25.85it/s]
-------------------------------------------------- Epoch: 1 cost time: 3.431600570678711
0it [00:00, ?it/s]4it [00:00, 32.88it/s]9it [00:00, 39.25it/s]14it [00:00, 41.36it/s]20it [00:00, 45.64it/s]25it [00:00, 45.53it/s]30it [00:00, 45.18it/s]35it [00:00, 45.60it/s]41it [00:00, 47.13it/s]47it [00:01, 48.15it/s]53it [00:01, 48.92it/s]59it [00:01, 49.38it/s]65it [00:01, 49.66it/s]71it [00:01, 49.87it/s]77it [00:01, 49.97it/s]82it [00:01, 49.09it/s]87it [00:01, 47.90it/s]92it [00:01, 48.38it/s]97it [00:02, 47.84it/s]102it [00:02, 48.05it/s]107it [00:02, 47.68it/s]112it [00:02, 47.08it/s]117it [00:02, 44.62it/s]122it [00:02, 44.10it/s]127it [00:02, 42.87it/s]132it [00:02, 42.81it/s]137it [00:02, 43.00it/s]142it [00:03, 42.93it/s]147it [00:03, 42.80it/s]152it [00:03, 43.58it/s]157it [00:03, 44.18it/s]162it [00:03, 44.99it/s]167it [00:03, 44.70it/s]172it [00:03, 44.49it/s]177it [00:03, 43.86it/s]182it [00:03, 44.78it/s]187it [00:04, 45.62it/s]192it [00:04, 46.33it/s]197it [00:04, 46.00it/s]202it [00:04, 46.61it/s]207it [00:04, 46.52it/s]212it [00:04, 46.59it/s]217it [00:04, 46.64it/s]222it [00:04, 47.14it/s]227it [00:04, 46.39it/s]232it [00:05, 46.73it/s]237it [00:05, 46.64it/s]242it [00:05, 47.19it/s]247it [00:05, 47.34it/s]252it [00:05, 46.80it/s]257it [00:05, 46.77it/s]262it [00:05, 46.72it/s]267it [00:05, 46.60it/s]273it [00:05, 47.27it/s]278it [00:06, 47.17it/s]283it [00:06, 47.24it/s]289it [00:06, 48.87it/s]295it [00:06, 51.42it/s]301it [00:06, 53.30it/s]304it [00:06, 46.14it/s]
Epoch: 1, Steps: 78 | Train Loss: 0.4909372 Vali Loss: 0.9554307
lr = 0.0000993845
Validation loss decreased (inf --> 0.955431).  Saving model ...
------------------------------------
0it [00:00, ?it/s]5it [00:00, 48.84it/s]12it [00:00, 57.32it/s]19it [00:00, 59.50it/s]25it [00:00, 59.49it/s]31it [00:00, 59.41it/s]37it [00:00, 59.35it/s]43it [00:00, 59.34it/s]49it [00:00, 59.35it/s]55it [00:00, 58.76it/s]61it [00:01, 58.78it/s]67it [00:01, 58.86it/s]73it [00:01, 59.03it/s]79it [00:01, 59.15it/s]85it [00:01, 59.30it/s]91it [00:01, 59.32it/s]97it [00:01, 59.29it/s]103it [00:01, 59.31it/s]109it [00:01, 59.38it/s]115it [00:01, 59.44it/s]121it [00:02, 59.32it/s]127it [00:02, 59.23it/s]133it [00:02, 59.18it/s]139it [00:02, 59.17it/s]145it [00:02, 59.22it/s]151it [00:02, 59.17it/s]157it [00:02, 59.24it/s]163it [00:02, 59.24it/s]169it [00:02, 59.22it/s]175it [00:02, 59.24it/s]181it [00:03, 59.19it/s]187it [00:03, 59.11it/s]193it [00:03, 59.12it/s]199it [00:03, 59.14it/s]205it [00:03, 58.98it/s]211it [00:03, 58.99it/s]217it [00:03, 58.99it/s]223it [00:03, 59.08it/s]229it [00:03, 59.11it/s]235it [00:03, 58.49it/s]241it [00:04, 58.68it/s]247it [00:04, 58.88it/s]253it [00:04, 59.01it/s]259it [00:04, 59.16it/s]265it [00:04, 59.13it/s]271it [00:04, 59.18it/s]277it [00:04, 59.19it/s]283it [00:04, 59.28it/s]289it [00:04, 59.43it/s]296it [00:05, 59.69it/s]303it [00:05, 59.74it/s]304it [00:05, 58.47it/s]
test shape: (304, 64, 96, 1) (304, 64, 96, 1)
test shape: (19456, 96, 1) (19456, 96, 1)
mae:0.4785, mse:0.5320, rmse:0.7294, smape:82.6016
-------------------------------------------------- TEST time = 5.767067909240723
mse_mean = 0.5320, mse_std = 0.0000
mae_mean = 0.4785, mae_std = 0.0000
self vs thop trainable params 3252576 2.466M
****************************************************************************************************
======================================== Runtime metrics ========================================
MACs = 20.749G
params = 2.466M
total params = 84.359M
epoch time = 3.431600570678711
max memory = 1.445G
test time = 5.767067909240723
****************************************************************************************************
